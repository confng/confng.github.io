<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Reference - ConfNG</title>
    <meta name="description" content="Complete API reference for ConfNG configuration management library.">
    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/docs.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="../index.html">ConfNG</a>
            </div>
            <div class="nav-menu" id="nav-menu">
                <a href="../index.html" class="nav-link">Home</a>
                <a href="../index.html#features" class="nav-link">Features</a>
                <a href="../index.html#quick-start" class="nav-link">Quick Start</a>
                <a href="../guide/index.html" class="nav-link">Documentation</a>
                <a href="../index.html#examples" class="nav-link">Examples</a>
                <a href="index.html" class="nav-link active">API</a>
                <a href="https://github.com/confng/confng" class="nav-link" target="_blank">GitHub</a>
            </div>
            <div class="nav-toggle" id="nav-toggle">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
        </div>
    </nav>

    <div class="docs-layout">
        <aside class="docs-sidebar">
            <div class="sidebar-content">
                <h3>API Reference</h3>
                <nav class="sidebar-nav">
                    <a href="#confng-class" class="sidebar-link">ConfNG Class</a>
                    <a href="#confngkey-interface" class="sidebar-link">ConfNGKey Interface</a>
                    <a href="#configsource-interface" class="sidebar-link">ConfigSource Interface</a>
                    <a href="#secretmanagersource" class="sidebar-link">SecretManagerSource</a>
                    <a href="#built-in-sources" class="sidebar-link">Built-in Sources</a>
                    <a href="#exceptions" class="sidebar-link">Exceptions</a>
                </nav>
            </div>
        </aside>

        <main class="docs-main">
            <div class="docs-content">
                <header class="docs-header">
                    <h1>API Reference</h1>
                    <p>Complete API documentation for ConfNG classes, interfaces, and methods.</p>
                    <p><strong>New Feature:</strong> ConfNG now automatically detects TestNG projects and loads parameters from testng.xml suite and test level <parameter> tags.</p>
                </header>

                <section id="confng-class" class="docs-section">
                    <h2>ConfNG Class</h2>
                    <p>The main entry point for configuration management. Provides static methods for loading sources and accessing configuration values.</p>

                    <h3>Configuration Access Methods</h3>
                    
                    <h4>get(ConfNGKey key)</h4>
                    <pre><code class="language-java">public static String get(ConfNGKey key)</code></pre>
                    <p>Gets a configuration value as a string.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>key</code> - the configuration key</li>
                        <li><strong>Returns:</strong> the configuration value, or the default value if not found</li>
                        <li><strong>Example:</strong> <code>String browser = ConfNG.get(TestConfig.BROWSER);</code></li>
                    </ul>

                    <h4>getInt(ConfNGKey key)</h4>
                    <pre><code class="language-java">public static Integer getInt(ConfNGKey key)</code></pre>
                    <p>Gets a configuration value as an integer.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>key</code> - the configuration key</li>
                        <li><strong>Returns:</strong> the configuration value as Integer, or null if not found and no default</li>
                        <li><strong>Throws:</strong> <code>IllegalArgumentException</code> if the value cannot be converted to integer</li>
                        <li><strong>Example:</strong> <code>Integer timeout = ConfNG.getInt(TestConfig.TIMEOUT);</code></li>
                    </ul>

                    <h4>getBoolean(ConfNGKey key)</h4>
                    <pre><code class="language-java">public static Boolean getBoolean(ConfNGKey key)</code></pre>
                    <p>Gets a configuration value as a boolean.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>key</code> - the configuration key</li>
                        <li><strong>Returns:</strong> the configuration value as Boolean, or null if not found and no default</li>
                        <li><strong>Throws:</strong> <code>IllegalArgumentException</code> if the value cannot be converted to boolean</li>
                        <li><strong>Example:</strong> <code>Boolean headless = ConfNG.getBoolean(TestConfig.HEADLESS);</code></li>
                    </ul>

                    <h3>Source Management Methods</h3>

                    <h4>loadProperties(String filePath)</h4>
                    <pre><code class="language-java">public static void loadProperties(String filePath)</code></pre>
                    <p>Loads a properties file as a configuration source.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>filePath</code> - path to the properties file</li>
                        <li><strong>Behavior:</strong> If the file doesn't exist, it's silently skipped. If the file exists but is invalid, throws a runtime exception.</li>
                        <li><strong>Example:</strong> <code>ConfNG.loadProperties("test.properties");</code></li>
                    </ul>

                    <h4>loadJson(String filePath)</h4>
                    <pre><code class="language-java">public static void loadJson(String filePath)</code></pre>
                    <p>Loads a JSON file as a configuration source.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>filePath</code> - path to the JSON file</li>
                        <li><strong>Behavior:</strong> If the file doesn't exist, it's silently skipped. If the file exists but is invalid, throws a runtime exception.</li>
                        <li><strong>Example:</strong> <code>ConfNG.loadJson("config.json");</code></li>
                    </ul>

                    <h4>loadSecretSource(ConfigSource source)</h4>
                    <pre><code class="language-java">public static void loadSecretSource(ConfigSource source)</code></pre>
                    <p>Loads a custom secret source.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>source</code> - the custom configuration source to add</li>
                        <li><strong>Example:</strong> <code>ConfNG.loadSecretSource(new AWSSecretsSource());</code></li>
                    </ul>

                    <h4>registerSource(ConfigSource source)</h4>
                    <pre><code class="language-java">public static void registerSource(ConfigSource source)</code></pre>
                    <p>Registers a configuration source at the end of the precedence list.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>source</code> - the configuration source to add</li>
                        <li><strong>Example:</strong> <code>ConfNG.registerSource(new DatabaseConfigSource());</code></li>
                    </ul>

                    <h4>registerSourceAt(int precedenceIndex, ConfigSource source)</h4>
                    <pre><code class="language-java">public static void registerSourceAt(int precedenceIndex, ConfigSource source)</code></pre>
                    <p>Registers a configuration source at a specific precedence position.</p>
                    <ul>
                        <li><strong>Parameters:</strong> 
                            <ul>
                                <li><code>precedenceIndex</code> - the position in the precedence list (0 = highest precedence)</li>
                                <li><code>source</code> - the configuration source to add</li>
                            </ul>
                        </li>
                        <li><strong>Throws:</strong> <code>IllegalArgumentException</code> if the precedence index is invalid</li>
                        <li><strong>Example:</strong> <code>ConfNG.registerSourceAt(0, new HighPrioritySource());</code></li>
                    </ul>

                    <h3>Resolution Management Methods</h3>

                    <h4>resolveAllValues()</h4>
                    <pre><code class="language-java">public static void resolveAllValues()</code></pre>
                    <p>Resolves all configuration values from all sources according to precedence. This method is called automatically when needed but can be called manually to force immediate resolution.</p>

                    <h4>resolveAllValues(Set&lt;String&gt; keys)</h4>
                    <pre><code class="language-java">public static void resolveAllValues(Set&lt;String&gt; keys)</code></pre>
                    <p>Resolves configuration values for the specified keys from all sources.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>keys</code> - specific keys to resolve, or null to discover all keys</li>
                    </ul>

                    <h4>refresh()</h4>
                    <pre><code class="language-java">public static void refresh()</code></pre>
                    <p>Forces re-resolution of all configuration values. Useful when configuration sources might have changed.</p>

                    <h3>Utility Methods</h3>

                    <h4>getForDisplay(ConfNGKey key)</h4>
                    <pre><code class="language-java">public static String getForDisplay(ConfNGKey key)</code></pre>
                    <p>Gets a configuration value with masking for sensitive data.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>key</code> - the configuration key</li>
                        <li><strong>Returns:</strong> the configuration value, masked if sensitive</li>
                        <li><strong>Example:</strong> <code>String maskedKey = ConfNG.getForDisplay(SecureConfig.API_KEY);</code></li>
                    </ul>

                    <h4>getAllForDisplay(ConfNGKey... keys)</h4>
                    <pre><code class="language-java">public static String getAllForDisplay(ConfNGKey... keys)</code></pre>
                    <p>Gets all configuration values for display purposes. Sensitive values are masked.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>keys</code> - the configuration keys to display</li>
                        <li><strong>Returns:</strong> a formatted string showing all configuration values</li>
                        <li><strong>Example:</strong> <code>String allConfigs = ConfNG.getAllForDisplay(TestConfig.values());</code></li>
                    </ul>

                    <h4>getResolvedValueCount()</h4>
                    <pre><code class="language-java">public static int getResolvedValueCount()</code></pre>
                    <p>Gets the number of resolved configuration values.</p>

                    <h4>isResolved()</h4>
                    <pre><code class="language-java">public static boolean isResolved()</code></pre>
                    <p>Checks if configuration values have been resolved.</p>

                    <h4>getResolvedKeys()</h4>
                    <pre><code class="language-java">public static Set&lt;String&gt; getResolvedKeys()</code></pre>
                    <p>Gets all resolved configuration keys.</p>
                </section>

                <section id="confngkey-interface" class="docs-section">
                    <h2>ConfNGKey Interface</h2>
                    <p>Interface that defines configuration keys. Typically implemented by enums to provide type-safe configuration access.</p>

                    <h3>Methods</h3>

                    <h4>getKey()</h4>
                    <pre><code class="language-java">String getKey()</code></pre>
                    <p>Returns the string key used to look up the configuration value.</p>

                    <h4>getDefaultValue()</h4>
                    <pre><code class="language-java">default String getDefaultValue() {
    return null;
}</code></pre>
                    <p>Returns the default value for this configuration key. Override to provide a default.</p>

                    <h4>isSensitive()</h4>
                    <pre><code class="language-java">default boolean isSensitive() {
    return false;
}</code></pre>
                    <p>Returns true if this configuration key contains sensitive data that should be masked in logs.</p>

                    <h3>Implementation Example</h3>
                    <pre><code class="language-java">public enum TestConfig implements ConfNGKey {
    BROWSER("browser", "chrome"),
    API_KEY("api.key", null, true);
    
    private final String key;
    private final String defaultValue;
    private final boolean sensitive;
    
    TestConfig(String key, String defaultValue) {
        this(key, defaultValue, false);
    }
    
    TestConfig(String key, String defaultValue, boolean sensitive) {
        this.key = key;
        this.defaultValue = defaultValue;
        this.sensitive = sensitive;
    }
    
    @Override
    public String getKey() {
        return key;
    }
    
    @Override
    public String getDefaultValue() {
        return defaultValue;
    }
    
    @Override
    public boolean isSensitive() {
        return sensitive;
    }
}</code></pre>
                </section>

                <section id="configsource-interface" class="docs-section">
                    <h2>ConfigSource Interface</h2>
                    <p>Interface for configuration sources. Implement this interface to create custom configuration sources.</p>

                    <h3>Methods</h3>

                    <h4>getName()</h4>
                    <pre><code class="language-java">String getName()</code></pre>
                    <p>Returns a descriptive name for this configuration source.</p>

                    <h4>get(String key)</h4>
                    <pre><code class="language-java">Optional&lt;String&gt; get(String key)</code></pre>
                    <p>Gets a configuration value for the given key.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>key</code> - the configuration key</li>
                        <li><strong>Returns:</strong> Optional containing the value if found, empty otherwise</li>
                    </ul>

                    <h3>Implementation Example</h3>
                    <pre><code class="language-java">public class DatabaseConfigSource implements ConfigSource {
    private final Map&lt;String, String&gt; configCache = new HashMap&lt;&gt;();
    
    public DatabaseConfigSource(DataSource dataSource) {
        // Load configuration from database
        loadFromDatabase(dataSource);
    }
    
    @Override
    public String getName() {
        return "DatabaseConfig";
    }
    
    @Override
    public Optional&lt;String&gt; get(String key) {
        return Optional.ofNullable(configCache.get(key));
    }
    
    private void loadFromDatabase(DataSource dataSource) {
        // Implementation details...
    }
}</code></pre>
                </section>

                <section id="secretmanagersource" class="docs-section">
                    <h2>SecretManagerSource Class</h2>
                    <p>Abstract base class for secret manager implementations. Provides common functionality such as caching, key mapping, and error handling.</p>

                    <h3>Constructors</h3>

                    <h4>SecretManagerSource(long cacheTimeoutMs)</h4>
                    <pre><code class="language-java">protected SecretManagerSource(long cacheTimeoutMs)</code></pre>
                    <p>Creates a new secret manager source with caching enabled.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>cacheTimeoutMs</code> - cache timeout in milliseconds (0 = no timeout)</li>
                    </ul>

                    <h4>SecretManagerSource()</h4>
                    <pre><code class="language-java">protected SecretManagerSource()</code></pre>
                    <p>Creates a new secret manager source with caching disabled.</p>

                    <h3>Methods</h3>

                    <h4>addKeyMapping(String configKey, String secretId)</h4>
                    <pre><code class="language-java">public void addKeyMapping(String configKey, String secretId)</code></pre>
                    <p>Maps a configuration key to a secret identifier.</p>
                    <ul>
                        <li><strong>Parameters:</strong>
                            <ul>
                                <li><code>configKey</code> - the configuration key</li>
                                <li><code>secretId</code> - the secret identifier in the secret manager</li>
                            </ul>
                        </li>
                    </ul>

                    <h4>fetchSecret(String secretId)</h4>
                    <pre><code class="language-java">protected abstract String fetchSecret(String secretId) throws Exception</code></pre>
                    <p>Fetches a secret from the secret manager. Must be implemented by subclasses.</p>
                    <ul>
                        <li><strong>Parameters:</strong> <code>secretId</code> - the secret identifier</li>
                        <li><strong>Returns:</strong> the secret value, or null if not found</li>
                        <li><strong>Throws:</strong> Exception if an error occurs while fetching the secret</li>
                    </ul>

                    <h4>clearCache()</h4>
                    <pre><code class="language-java">public void clearCache()</code></pre>
                    <p>Clears the secret cache.</p>

                    <h4>getCacheSize()</h4>
                    <pre><code class="language-java">public int getCacheSize()</code></pre>
                    <p>Gets the number of cached secrets.</p>

                    <h3>Implementation Example</h3>
                    <pre><code class="language-java">public class AWSSecretsSource extends SecretManagerSource {
    private final SecretsManagerClient client;
    
    public AWSSecretsSource() {
        super(300000); // 5 minute cache
        this.client = SecretsManagerClient.builder()
            .region(Region.US_EAST_1)
            .build();
    }
    
    @Override
    public String getName() {
        return "AWSSecretsManager";
    }
    
    @Override
    protected String fetchSecret(String secretId) throws Exception {
        GetSecretValueRequest request = GetSecretValueRequest.builder()
            .secretId(secretId)
            .build();
        
        GetSecretValueResponse response = client.getSecretValue(request);
        return response.secretString();
    }
}</code></pre>
                </section>

                <section id="built-in-sources" class="docs-section">
                    <h2>Built-in Configuration Sources</h2>

                    <h3>EnvSource</h3>
                    <p>Reads configuration from environment variables. Automatically registered with highest precedence.</p>
                    <pre><code class="language-java">public class EnvSource implements ConfigSource {
    @Override
    public String getName() {
        return "Environment";
    }
    
    @Override
    public Optional&lt;String&gt; get(String key) {
        return Optional.ofNullable(System.getenv(key));
    }
}</code></pre>

                    <h3>SystemPropertySource</h3>
                    <p>Reads configuration from Java system properties. Automatically registered with second-highest precedence.</p>
                    <pre><code class="language-java">public class SystemPropertySource implements ConfigSource {
    @Override
    public String getName() {
        return "SystemProperties";
    }
    
    @Override
    public Optional&lt;String&gt; get(String key) {
        return Optional.ofNullable(System.getProperty(key));
    }
}</code></pre>

                    <h3>PropertiesSource</h3>
                    <p>Reads configuration from Java properties files.</p>
                    <pre><code class="language-java">public class PropertiesSource implements ConfigSource {
    public PropertiesSource(Path file) {
        // Loads properties from file
    }
    
    @Override
    public String getName() {
        return "Properties(" + file.toString() + ")";
    }
    
    @Override
    public Optional&lt;String&gt; get(String key) {
        // Returns property value
    }
}</code></pre>

                    <h3>JsonSource</h3>
                    <p>Reads configuration from JSON files using Gson for parsing.</p>
                    <pre><code class="language-java">public class JsonSource implements ConfigSource {
    public JsonSource(Path file) {
        // Loads JSON from file using Gson
    }
    
    @Override
    public String getName() {
        return "Json(" + file.toString() + ")";
    }
    
    @Override
    public Optional&lt;String&gt; get(String key) {
        // Returns JSON value as string
    }
}</code></pre>
                </section>

                <section id="exceptions" class="docs-section">
                    <h2>Exceptions</h2>

                    <h3>IllegalArgumentException</h3>
                    <p>Thrown by type conversion methods when values cannot be converted to the requested type.</p>

                    <h4>Common Scenarios</h4>
                    <ul>
                        <li><strong>getInt():</strong> When the configuration value is not a valid integer</li>
                        <li><strong>getBoolean():</strong> When the configuration value is not "true" or "false" (case-insensitive)</li>
                    </ul>

                    <h4>Example</h4>
                    <pre><code class="language-java">try {
    Integer timeout = ConfNG.getInt(TestConfig.TIMEOUT);
} catch (IllegalArgumentException e) {
    // Handle invalid number format
    System.err.println("Invalid timeout value: " + e.getMessage());
    // Use default or alternative handling
    Integer timeout = 30;
}</code></pre>

                    <h3>RuntimeException</h3>
                    <p>Thrown when configuration files exist but cannot be loaded or parsed.</p>

                    <h4>Common Scenarios</h4>
                    <ul>
                        <li><strong>loadProperties():</strong> When properties file exists but has invalid format</li>
                        <li><strong>loadJson():</strong> When JSON file exists but has invalid JSON syntax</li>
                        <li><strong>registerSourceAt():</strong> When precedence index is invalid</li>
                    </ul>

                    <h4>Example</h4>
                    <pre><code class="language-java">try {
    ConfNG.loadJson("config.json");
} catch (RuntimeException e) {
    System.err.println("Failed to load JSON config: " + e.getMessage());
    // Handle error or use alternative configuration
}</code></pre>
                </section>
            </div>
        </main>
    </div>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>ConfNG</h3>
                    <p>Lightweight configuration management for Java projects.</p>
                </div>
                <div class="footer-section">
                    <h4>Documentation</h4>
                    <ul>
                        <li><a href="../guide/index.html">User Guide</a></li>
                        <li><a href="index.html">API Reference</a></li>
                        <li><a href="../migration/index.html">Migration Guide</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 ConfNG. Licensed under the MIT License.</p>
            </div>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/docs.js"></script>
</body>
</html>
